// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

// Regular Tables
Table public.user {
  id uuid [primary key]
  first_name varchar(100)
  middle_name varchar(100)
  last_name varchar(100)
  gender varchar(1) [note: 'M, F, N']
  email_address varchar(250)
  ssn varchar(11)
  birthday date
  status varchar(10) [note: 'ACTIVE, INACTIVE, LOCKED, BANNED, DELETED']
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table public.user_phone {
  id uuid [primary key]
  user_id uuid [not null]
  phone_number varchar(20) [not null]
  phone_type varchar(6) [not null, note: 'HOME, MOBILE, WORK, FAX']
  is_primary boolean [default: false]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table public.user_address {
  id uuid [primary key]
  user_id uuid [not null]
  address_line_1 varchar(250)
  address_line_2 varchar(250)
  address_line_3 varchar(250)
  state varchar(50)
  city varchar(250)
  zipcode varchar(20)
  country varchar(100)
  is_primary boolean [default: false]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table public.user_login {
  id uuid [primary key]
  user_id uuid [not null]
  username varchar(50) [not null]
  password text [not null]
  hash_algorithm varchar(50) [not null]
  last_login_date timestamp
  password_attempts integer [not null, default: 0]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table public.user_role {
  user_id uuid [not null]
  role_name varchar(10) [not null]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
}

Ref fk_user_id_user_phone: public.user_phone.user_id > public.user.id

Ref fk_user_id_user_address: public.user_address.user_id > public.user.id

Ref fk_user_id_user_login: public.user_login.user_id > public.user.id

Ref fk_user_id_user_role: public.user_role.user_id > public.user.id

// Audit Tables
Table audit.user_aud {
  id uuid [primary key]
  action varchar(6) [note: 'INSERT, UPDATE, DELETE']
  user_id uuid [not null]
  first_name varchar(100)
  middle_name varchar(100)
  last_name varchar(100)
  gender varchar(1) [note: 'M, F, N']
  email_address varchar(250)
  ssn varchar(10)
  birthday date
  status varchar(10) [note: 'ACTIVE, INACTIVE, LOCKED, BANNED, DELETED']
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table audit.user_phone_aud {
  id uuid [primary key]
  action varchar(6) [note: 'INSERT, UPDATE, DELETE']
  user_phone_id uuid [not null]
  user_id uuid [not null]
  phone_number varchar(20) [not null]
  phone_type varchar(6) [not null, note: 'HOME, MOBILE, WORK, FAX']
  is_primary boolean [default: false]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table audit.user_address_aud {
  id uuid [primary key]
  action varchar(6) [note: 'INSERT, UPDATE, DELETE']
  user_address_id uuid [not null]
  user_id uuid [not null]
  address_line_1 varchar(250)
  address_line_2 varchar(250)
  address_line_3 varchar(250)
  state varchar(50)
  city varchar(250)
  zipcode varchar(20)
  country varchar(100)
  is_primary boolean [default: false]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table audit.user_login_aud {
  id uuid [primary key]
  action varchar(6) [note: 'INSERT, UPDATE, DELETE']
  user_login_id uuid [not null]
  user_id uuid [not null]
  username varchar(50) [not null]
  password text [not null]
  hash_algorithm varchar(50) [not null]
  last_login_date timestamp
  password_attempts integer [not null, default: 0]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
  updated_at timestamp [default: `now()`]
  updated_by varchar(50)
}

Table audit.user_role_aud {
  id uuid [primary key]
  action varchar(10) [note: 'INSERT, UPDATE, DELETE']
  user_id uuid [not null]
  role_name varchar(6) [not null]
  created_at timestamp [default: `now()`]
  created_by varchar(50)
}
